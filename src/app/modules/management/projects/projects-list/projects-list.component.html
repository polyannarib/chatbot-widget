<app-loading [loader]="loader"></app-loading>

<div *ngIf="projectsList && !loader">
  
  <div class="row">
    <div class="col s12 m6">
      <div class="input-field">
        <input autocomplete="off" id="findProject" (keyup)="onSearchChangeProject($event.target.value)" matInput id="findProject" type="text" class="validate" value="">
        <label for="findProject">Buscar projetos</label>
      </div>
    </div>
    <div class="col m3 s12">
      <ul>
        <li><a (click)="changeDays('prev')" [ngStyle]="{'background-color': mainStyle}" class="button button-floating"><i class="material-icons">chevron_left</i></a></li>
        <li><a (click)="changeDays('next')" [ngStyle]="{'background-color': mainStyle}" class="button button-floating"><i class="material-icons">chevron_right</i></a></li>
      </ul>
    </div>
    <!-- <div class="col m3 s12">
      <button class="button button-primary button-floating right" mat-icon-button matTooltip="{{ 'ADDPROJECT' | translate }}">
        <i (click)="finalize()" class="material-icons">add</i>
      </button>
    </div> -->
  </div>

  <app-loading [loader]="loaderDays && !daysOfWeek10"></app-loading>
  
  <div class="tableOverflow">
    <table class="responsive-table" *ngIf="!loaderDays && daysOfWeek10">
      <thead>
        <tr>
          <th class="projectCode">{{ 'CODE' | translate }}</th>
          <th>{{ 'PROJECTNAME' | translate }}</th>
          <th *ngFor="let day of daysOfWeek10">{{ day | date:'E' }}</th>
          <th class="hour">{{ 'HOURS' | translate }}</th>
          <th>{{ 'DATE' | translate }}</th>
          <th>{{ 'RSC' | translate }}</th>
          <th>{{ 'EXP' | translate }}</th>
          <th>{{ 'EFF' | translate }}</th>
          <!-- <th>{{ 'EDIT' | translate }}</th> -->
          <th *ngIf="!scopes.wpplayer"><!-- {{ 'STATUSREPORT' | translate }} --></th>
          <th *ngIf="!scopes.wpplayer"><!-- {{ 'GENERATEREPORT' | translate }} --></th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let project of filteredProjectsList">
          <tr class="card">
            <td class="projectCode"><b>{{ project.code }}</b></td>
            <td>{{ project.name }}</td>
            <ng-container *ngFor="let activity of project.tasks">
              <td class="days">
                <button class="btnDayCalendar" [ngClass]="{hoverable: activity.validDay}" [ngStyle]="{'background-color': activity.style}" [disabled]="!activity.validDay" (click)="modalProjectDetails(project.id, activity)"><span [ngClass]="{'animated infinite fadeIn': !activity.allocated}">{{ activity.referenceDate | date:'dd' }}</span></button>
              </td>
            </ng-container>
            <td class="fontMin"><b>Real:</b> {{ project.actualEffort }} <br><b>Prev:</b> {{ project.predictEffort }}</td>
            <td class="fontMin">{{ project.actualConclusion}} <br> {{ project.predictConclusion }}</td>
            <td>
              <i class="material-icons" [ngStyle]="{ 'color': project.riskProject }">fiber_manual_record</i>
            </td>
            <td>
              <i class="material-icons" [ngStyle]="{ 'color': project.expectedStyle }">fiber_manual_record</i>
            </td>
            <td>
              <i class="material-icons" [ngStyle]="{ 'color': project.effortStyle }">fiber_manual_record</i>
            </td>
            <!-- <td>
              <button matTooltip="{{ 'EDIT' | translate }}" mat-icon-button (click)="openProjectEdit(project)"><i class="material-icons">more_vert</i></button>
            </td> -->
            <td *ngIf="!scopes.wpplayer">
              <button matTooltip="{{ 'STATUSREPORT' | translate }}" mat-icon-button (click)="openReport(project)"><i class="material-icons">report</i></button>
            </td>
            <td *ngIf="!scopes.wpplayer">
              <button matTooltip="{{ 'GENERATEREPORT' | translate }}" mat-icon-button (click)="generateReport(project)"><i class="material-icons">send</i></button>
            </td>
          </tr>
          <tr>
            <td class="playerCompleted">{{ project.completed }}%</td>
            <td>
              <div class="progress">
                <div class="determinate" [ngStyle]="{'background-color': secondarytyle}" [ngStyle]="{'width': project.completed+'%'}"></div>
              </div>
            </td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>
